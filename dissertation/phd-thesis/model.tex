%%% -*-LaTeX-*-

\chapter{Mathematical Rolling Model}
\label{cha:model}

This chapter presents a new model of cell rolling which is similar to
the adhesive dynamics models in that it models bond chemistry as a
stochastic process and computes forces generated by each bond
individually, but simplifies the motion of the cell to translation and
rotation in one dimension, and ignores colloidal forces acting on the
cell. There are two models presented below which rely on the same set
of physical and biological assumptions, described in section
\ref{sec:problem-description}. The deterministic model presented in
section \ref{sec:determ-pde-model} is a mean-field model of platelet
rolling, analogous to the reaction rate equation in chemical kinetics
\cite{Gillespie2007}. The stochastic model presented in section
\ref{sec:stochastic-model} is derived from the same assumptions of the
deterministic model, with the exception that it tracks bonds as
discrete entities which form and break randomly.

\section{Problem description}
\label{sec:problem-description}

Below I describe the set of assumptions that we use to model a
platelet translating along an agonist-coated surface. Some important
experimentally variable biological and physical parameters such as
receptor and ligand density, receptor on/off rates, shear rate, and
fluid viscosity appear in the model.

\begin{figure}
  \centering
  \input{model-geometry}
  \caption[Geometry of the platelet rolling model]{Geometry of the
    platelet rolling model. The platelet is approximated as a sphere
    moving in a 2D shear flow. The reactive region on the platelet
    surface in which receptors on the platelet are close enough to
    ligands on the wall to bind is approximated with a finite
    cylinder. The coordinates $\recAngle$ and $\wallDist$ define the
    platelet and wall attachment points of a bond.}
  \label{fig:model-geometry}
\end{figure}

\subsection{Geometry and physics}
\label{sec:geometry-physics}

A sketch of the problem geometry is given in Figure
\ref{fig:model-geometry}. Assume we have a circular rigid platelet (of
radius $\radius$) rolling and translating in shear flow with shear
rate $\shear$ adjacent to a wall. The platelet translates parallel to
the wall at speed $\velocity$, and rolls at angular velocity
$\rotation$. Because the circle is always translating parallel to the
wall, there is a fixed vertical distance $\separation$ between the
wall and the closest point on the circle. Define the height $\height$
of the platelet to be the distance from the wall to the center of the
platelet ($\height = \separation + \radius$). The fluid forces exerted
on the platelet are a function of $\height$, $\radius$, $\shear$, and
$\velocity$, as well as the fluid viscosity ($\viscosity$) which is
constant across all experiments. We assume that the platelet is moving
in a Stokes flow, meaning that inertial forces are negligible and
force balance must be satisfied on the platelet at all times.

Due to the linearity of Stokes equations:
\begin{align}
  \label{eq:stokes-momentum}
  0 &= -\nabla p + \mu\Delta \mathbf{u} + \mathbf{F}\\
  \label{eq:stokes-mass}
  0 &= \nabla \cdot \mathbf{u},
\end{align}
there is a linear relationship between platelet velocity and drag
force from the fluid acting on the platelet. In a 3D Stokes flow, this
relationship is given by a $6 \times 6$ matrix equation
$\mathbf{F}_\tn{drag} = \underline{\underline{R}} \mathbf{U}$ where
$\mathbf{U}$ is a $6 \times 1$ vector containing the 3 translational
velocities and 3 rotational velocities, and $\mathbf{F}$ is a
$6 \times 1$ vector containing the 3 forces and 3 torques. However in
the current model we have made a number of simplifying assumptions.
\begin{enumerate}
\item We assume the flow is a 2D Stokes flow, eliminating all forces
  and translational velocities along the dimension going into and out
  of the page. This also eliminates rotations and torques about the
  two dimensions on the page. Similarly the platelet geometry is a
  circle in 2D. We arrive at this assumption by assuming the platelet
  is a sphere in 3D, but due to the length-dependence of bond
  formation and breaking there is only a narrow reactive strip of
  width $\width$ along the bottom of the platelet in which bonds
  exist. We then approximate this narrow reaction region with a finite
  cylinder of height $\width$ and radius $\radius$.
\item The platelet remains at a constant separation distance from the
  wall, eliminating all vertical motion (and consequently ignoring all
  vertical forces imposed by bonds between the platelet and wall). In
  published adhesive dynamics models, the nonspecific repulsive forces
  between the platelet and vessel wall are only significant at very
  short ranges, therefore it is plausible that at the length scales
  relevant to the problem, the height of the platelet from the surface
  does not change, and bond forces pulling the platelet towards the
  wall are balanced by the nonspecific repulsive forces.
\item The hydrodynamic forces on the platelet are computed assuming
  the platelet is infinitely far from the wall. In particular the
  translational velocity of the platelet is assumed to be independent
  of the torque, and vice versa. This assumption is nonphysical,
  however it does simplify the relationship between bond forces and
  torques and the platelet translation and angular velocities. In the
  near future, I will remove this assumption and instead use the
  formulae of Goldman, Cox, and Brenner
  \cite{Goldman1967a,Goldman1967b} to find the drag force on the
  platelet (see section \ref{sec:height-depend-fluid}).
\end{enumerate}
With these assumptions in place, the force balance condition reduces
to two decoupled linear equations relating the horizontal force
($\horzTotalForce$) to the translational velocity ($\velocity$) and
relating the torque ($\totalTorque$) to the rotational velocity
($\rotation$):
\begin{align}
  \label{eq:force-bal}
  0 &= \velFriction(\appliedVel - \velocity) + \horzTotalForce \\
  \label{eq:torque-bal}
  0 &= \rotFriction(\appliedRot - \rotation) + \totalTorque
\end{align}
% Equations.
% NOTE: I will need to expand on this more when I add equations to
% the paper. I also forgot to discuss the applied fluid velocities.

We identify bonds by their two attachment points on the wall and on
the platelet surface, so each bond has two coordinates associated with
it for each of its endpoints. Points on the wall are given by the
coordinate $\wallDist$, defined to be the horizontal distance from the
center of the circle, and points on the platelet surface are given by
the coordinate $\recAngle$, defined to be the angle formed by the
receptor, the center of the circle, and the closest point on the
circle to the wall (Figure \ref{fig:model-geometry}). With this
definition of $\wallDist$ and $\recAngle$, the distance from a ligand at
$\wallDist$ on wall and a receptor $\recAngle$ on the platelet surface is
given by the equation
\begin{equation}
  \label{eq:dim-length}
  \length^2 (\wallDist, \recAngle) \equiv (\radius - \radius\cos\recAngle +
  \separation)^2 + (\radius\sin\recAngle - \wallDist)^2.
\end{equation}

\subsection{Biology}
\label{sec:biology}

The platelet surface is covered with receptors at an angular density
of $\receptorDensity$ receptors/radian, and bonds can form between
points on the surface of the circle and points on the wall. The number
of ligand binding sites on the substrate is assumed to be in
excess. We assume that bonds act like Hookean springs with a rest
length of 0, so the force exerted by a bond is proportional to its
length and the proportionality constant is the stiffness of the
bond. Formation and dissociation rates are distance and force
dependent, respectively. We use the Bell model \cite{Bell1978} to
express the bond dissociation rate as a function of force. The bond
formation rate comes from assuming that the binding site on the ligand
is normally distributed in space, therefore the bond formation rate is
proportional to a Gaussian function of bond length. Therefore the
equations for formation rate and dissociation rate are the following:
\begin{align}
  \label{eq:binding}
  \onRate(\length) &= \onConst \exp
                     \left(-\frac{\stiffness}{2\boltzmann\temp}
                     \length^2(\wallDist, \recAngle) \right), \\
  \label{eq:unbinding}
  \offRate(\length) &= \offConst \exp \left( \frac{\stiffness
                      \length(\wallDist, \recAngle)}{\refForce} \right).
\end{align}

In order to calculate $\horzForce$ and $\torque$ for an existing set
of bonds between the platelet and wall, we simply have to add up the
individual contributions to the force and torque from each bond. The
force and torque generated by an individual bond can be derived from
the geometry of the model along with the assumption that the force
vector $\mathbf{F}$ points in the same direction as the bond with
magnitude proportional to the bond length. The horizontal force
generated by a single bond ($\horzForce$) is given simply by
\begin{equation}
  \label{eq:horz-force}
  \horzForce = \stiffness (\wallDist - \radius\sin\recAngle),
\end{equation}
while the torque generated by a single bond ($\torque$) is given by
the somewhat more complicated
\begin{equation}
  \label{eq:torque}
  \torque = -\stiffness \radius ((\radius - \radius\cos\recAngle +
  \separation)\sin\recAngle + (\radius\sin\recAngle -
  \wallDist)\cos\recAngle).
\end{equation}

\section{Deterministic PDE model}
\label{sec:determ-pde-model}

If we assume that there is a continuous distribution of bonds between
the platelet and the wall, we can define the function
$\bondDensity(\wallDist, \recAngle, \dTime)$ which gives the density of
bonds at time $\dTime$ between points $\wallDist$ and $\recAngle$ on the
wall and platelet, respectively. Bonds advect in $\wallDist$ with
velocity $\velocity$ and they advect in $\recAngle$ with velocity
$\rotation$. Bonds form at the rate given in equation
(\ref{eq:binding}) and saturate in $\recAngle$ with a maximum density
$\receptorDensity$. Finally, bonds break at the force-dependent rate
given in equation (\ref{eq:unbinding}). Putting all of this together
gives us the following PDE definition of $\bondDensity$:
\begin{equation}
  \label{eq:bond-density}
  \Pder{\bondDensity}{\dTime} = \rotation
  \Pder{\bondDensity}{\recAngle} + \velocity
  \Pder{\bondDensity}{\wallDist} + \onRate(\length)
  \left(\receptorDensity - \DimReceptorSaturation \right) -
  \offRate(\length) \bondDensity(\wallDist, \recAngle, \dTime).
\end{equation}

This equation can't yet be solved for $\bondDensity$, because there
are still 2 unknowns in it: $\velocity$ and $\rotation$. Recall from
above that $\velocity$ and $\rotation$ are found by balancing the
fluid and bond forces acting on the platelet (equations
(\ref{eq:force-balance}) and (\ref{eq:torque-balance})). First, we
have to calculate the total force $\horzTotalForce$ and torque
$\totalTorque$ generated by the distribution of bonds $\bondDensity$:
\begin{align}
  \label{eq:horz-total-force}
  \horzTotalForce &= \DimQuantity{\horzForce}, \\ 
  \label{eq:total-torque}
  \totalTorque &= \DimQuantity{\torque}
\end{align}

Once we have $\horzTotalForce$ and $\totalTorque$, the platelet velocities
$\velocity$ and $\rotation$ are given by the equations:
\begin{align}
  \label{eq:force-balance}
  0 &= \velFriction (\appliedVel - \velocity) + \horzTotalForce, \\
  \label{eq:torque-balance}
  0 &= \rotFriction (\appliedRot - \rotation) + \totalTorque.
\end{align}

Now we have 3 equations in 3 unknowns and this is a closed system that
can be solved simultaneously for $\bondDensity$, $\velocity$, and
$\rotation$. We still need to define the domains of all three
variables, and give boundary conditions for $\bondDensity$ before we
can solve this system. Assume that bonds can only attach to the lower
half-circle of the platelet surface, while bonds can form at any point
along the wall. Thus we are solving $\bondDensity$ in the domain
$(-\infty, \infty) \times [-\pi/2, \pi/2]$. We need to enforce
boundary conditions at the upstream (with respect to variables
$\wallDist$ and $\recAngle$) ends of the $\wallDist$ and $\recAngle$
domains. Because we assume there are no bonds attached to the upper
half of the platelet, and because the equilibrium concentration of
bonds $\bondDensity \rightarrow 0$ as $L \rightarrow \infty$, we must
set homogeneous Dirichlet boundary conditions on both $\wallDist$ and
$\recAngle$. Finally we set the initial condition to be
$\bondDensity(\wallDist, \recAngle, 0) \equiv \bondDensity_0(\wallDist,
\recAngle)$.

In order to eliminate some parameters, we nondimensionalize this model
by introducing nondimensional coordinates
$\wallDist = \radius \ndWallDist$ and $\ndTime = \offConst \dTime$
(note that $\recAngle$ is already dimensionless) and nondimensional
functions $\radius \bondDensity = \receptorDensity \ndBondDensity$,
$\velocity = \radius \offConst \ndVelocity$, and
$\rotation = \offConst \ndRotation$. The details of the
nondimensionalization are included in Appendix \ref{app:nondim}, but
the final nondimensional set of equations is
\begin{align}
  \nonumber
  \Pder{\ndBondDensity}{\ndTime}
  &= \ndRotation \Pder{\ndBondDensity} {\recAngle} + \ndVelocity
    \Pder{\ndBondDensity}{\ndWallDist} + \ndOnConst \exp
    \left(-\frac{\onForceScale}{2} \ndLength^2(\ndWallDist, \recAngle)
    \right) \left(1 - \NDReceptorSaturation\right) \\
  \label{eq:nd-bond-density}
  &\qquad - \exp
    \left(\offForceScale\ndLength(\ndWallDist, \recAngle)\right)
    \ndBondDensity(\ndWallDist, \recAngle, \ndTime), \\
  \label{eq:nd-force-balance}
  0 &= \ndVelFriction \left(\ndAppliedVel - \ndVelocity\right) + 
      \ndHorzTotalForce, \\
  \label{eq:nd-torque-balance}
  0 &= \ndRotFriction \left(\ndAppliedRot - \ndRotation\right) +
      \ndTotalTorque.
\end{align}

The nondimensional bond length $\ndLength$ is given by
\begin{equation}
  \label{eq:nd-length}
  \ndLength^2(\ndWallDist, \recAngle) = (1 - \cos\recAngle +
  \ndSeparation)^2 + (\sin\recAngle - \ndWallDist)^2,
\end{equation}
and the nondimensional force $\ndHorzTotalForce$ and torque
$\ndTotalTorque$ are given by
\begin{align}
  \label{eq:nd-force}
  \ndHorzTotalForce &= \NDQuantity{(\ndWallDist - \sin\recAngle)} \\
  \label{eq:nd-torque}
  \ndTotalTorque &= \NDQuantity{\left[ \left(1 - \cos\recAngle +
                   \ndSeparation\right) \sin\recAngle +
                   \left(\sin\recAngle - \ndWallDist\right)
                   \cos\recAngle \right]}
\end{align}
A complete list of the nondimensional coordinates, functions, and
parameters with their definitions are given in Table
\ref{tab:nd-vars}.

\section{Stochastic model}
\label{sec:stochastic-model}

An assumption that is implicit in the deterministic model is that cell
rolling is mediated by a large number of bonds between the platelet
and the surface, and therefore by the law of large numbers randomness
of bond formation and breaking is inconsequential. This assumption is
not supported by previous rolling models, nor is it supported by
experimental observation. In \cite{Wang2013}, which models platelet
rolling along vWF, at no point during their numerical experiment does
the number of bonds between the platelet and surface exceed 9. Even in
models of leukocyte rolling, where the drag force on the cell is
several times greater than drag on a platelet, the number of bonds
between the cell and the surface is approximately 20 at any given
point in time.

Therefore, there is good evidence that rolling is mediated by a small
number of bonds that can halt a platelet, and the implicit assumption
in the deterministic model that there are many bonds is not valid. In
order to fully and accurately describe platelet rolling, we must model
bond formation and breaking as a stochastic process, and consequently
the rolling velocity of the platelet is a stochastic process.

\subsection{Assumptions in the stochastic model}
\label{sec:assumpt-stoch-model}

For the stochastic model---like the deterministic model---assume that
there are $\receptorDensity$ receptors per radian, and the receptors
are uniformly distributed along the surface of the platelet. Assume
there is an excess of ligand on the wall surface, so that bonds can
form anywhere along the wall and there is no saturation of bonds in
the $\wallDist$ dimension.

A bond can form between a receptor located at $\recAngle$ and a point
$\wallDist$ on the wall at ``rate'' $\onRate(\wallDist,
\recAngle)$. More precisely, the time $t_\tn{form}$ that it takes a
bond to form between $\wallDist$ and $\recAngle$ is exponentially
distributed with mean $1/\onRate(\wallDist, \recAngle)$. Similarly,
the time it takes a bond between $\recAngle$ and $\wallDist$ to break
is exponentially distributed with mean
$1/\offRate(\wallDist, \recAngle)$. Finally, a single bond between
$\wallDist$ and $\recAngle$ generates horizontal force and torque
which are given by $f_h$ and $\tau_s$ as defined in equations
(\ref{eq:horz-force}) and (\ref{eq:torque}). As in the continuous
model, assume that only bonds on the lower half-circle of the platelet
can interact with the wall surface.

One consideration that we must make in the stochastic model is how to
handle bond saturation. The PDE enforces a maximum bond density on the
surface of the platelet, but bond density does not make sense in the
stochastic model because bonds are discrete in this model. One
approach is tracking every receptor on the surface of the platelet---
bound or unbound---and assuming that each receptor can only form a
single bond. But there are thousands of receptors on a platelet
surface, and it is inefficient to track all of them and calculate bond
formation rates for all of them. A more flexible approach is described
below, which groups receptors into bins that move with the surface of
the platelet. This is just a generalization of the approach of
tracking each receptor individually: taking the number of bins
equal to the number of receptors reduces to the case of tracking each
receptor individually.

At the beginning of a simulation, I partition the entire platelet
surface $\theta \in [-\pi, \pi)$ into $2N$ subintervals of equal
length
$I_j(0) = \left[-\frac{\pi}{2} + \frac{\pi}{N}j, -\frac{\pi}{2} +
  \frac{\pi}{N} (j+1)\right)$. Each subinterval has width
$\nu \equiv \pi/N$. Within each subinterval $I_j$, there are
$b_\tn{max} \equiv \receptorDensity \pi/N$ total receptors, which are
all assumed to be located at the midpoint $\binMidpoint{j}$ of the
interval:
$\binMidpoint{j}(0) \equiv -\frac{\pi}{2} + \frac{\pi}{N} \left( j +
  \frac{1}{2} \right)$. As the simulation evolves, the intervals $I_j$
(and their midpoints $\binMidpoint{j}$) track with the surface of the
platelet as it rotates; that is, they form a Lagrangian partition of
the platelet surface (see Figure \ref{fig:plt-bins}).

\begin{figure}
  \centering
  \input{plt-bins}
  \caption[Partition of (part of) the platelet surface into
  $\recAngle$-bins.]{Partition of (part of) the platelet surface into
    $\recAngle$-bins. There are $b_\tn{max}$ total receptors in each
    $\recAngle$-bin, and they are all assumed to be located at the
    midpoint of the interval.}
  \label{fig:plt-bins}
\end{figure}

\subsection{A modified Gillespie algorithm}
\label{sec:modif-gill-algor}

In order to simulate the random bond breaking and formation, we have
to take into account the motion of the platelet as well as the
reaction rates for each possible binding/unbinding reaction. Because
every reaction has a spatially varying reaction rate and the platelet
is moving, each reaction rate changes over time. A naive way to
approach this is to modify the Gillespie algorithm by enforcing some
maximum time step, and if no reaction occurs within the maximum
allowed time step, update the position of the platelet without
creating any new bonds or destroying any existing ones. For now this
is our chosen approach, but a more efficient method for simulating the
stochastic model is developed in section \ref{sec:modif-next-react}

To summarize the current stochastic simulation method, each time step
begins by calculating the rates of all possible reactions. The
possible reactions are either the formation of a new bond from 1 of
the $N$ subintervals on the lower half of the platelet, or the
breaking of any existing bonds. Then two random numbers are generated
to choose the time $\Delta t$ until the first reaction and which
reaction occurred. The propensity for a bond of nondimensional length
$\ndLength$ to break is given by
$\exp(\offForceScale \ndLength(\ndWallDist, \recAngle))$, and the
propensity for a new bond to form from subinterval $j$ to \emph{any}
point on the wall is given by
$b_j^\tn{avail} \ndOnConst\Int{\exp\left(-\onForceScale \ndLength^2
  (\ndWallDist, \recAngle)/2\right)} {\ndWallDist} {-\infty} {\infty}$
although in practice this integral is truncated for consistency with
the deterministic model. The number of available receptors
$b_j^\tn{avail}$ in interval $I_j$ is given by $b_\tn{max} - n_j$
where $n_j$ is the number of receptors occupied by existing bonds.

If the chosen maximum time step $\Delta t_\tn{max}$ is smaller than
the time to the next reaction $\Delta t$, then no reactions occur and
the platelet position is updated. If $\Delta t < \Delta t_\tn{max}$,
update the position of the platelet and then update the bond list
based on which reaction occurred. If a bond is chosen to break, that
bond is simply removed. If a new bond is chosen to form from position
$\binMidpoint{j}$ on the platelet, then a point on the wall must be
selected to attach the bond to. This is described in more depth
below. Once the bond list is updated, new bond forces and torques are
calculated, and new velocities $\ndVelocity$ and $\ndRotation$ are
found. This process then repeats until the end of the simulation is
reached.

\subsubsection{Bond formation}
\label{sec:bond-formation}

As mentioned above, the propensity of bond formation from a point
$\binMidpoint{j}$ on the platelet to any point on the wall is the
integral over $\ndWallDist$ of the bond formation rate:
\begin{equation}
  \label{eq:new-bond-prop}
  a_j = b_j^\tn{avail} \ndOnConst \Int{\exp \left(-\frac{\onForceScale}{2}
      \ndLength^2 (\ndWallDist, \binMidpoint{j}) \right)} {\ndWallDist}
  {-\infty} {\infty}.
\end{equation}

Suppose a new bond is guaranteed to form with a platelet attachment
point $\binMidpoint{j}$. Then by reasoning similar to that used to
choose the next reaction in Gillespie algorithm, the probability that
the wall attachment point of that bond is in some interval
$[\ndWallDist_1, \ndWallDist_2]$ is just the proportion of the overall
integral (\ref{eq:new-bond-prop}) contained in that interval:
\begin{equation}
  \label{eq:wall-cum-dist}
  \mathbb{P} \left[\ndWallDist_\tn{new} \in [\ndWallDist_1,
    \ndWallDist_2] \right] = \frac{b_j^\tn{avail} \ndOnConst \Int{\exp
      \left( -\frac{\onForceScale}{2} \ndLength^2(\ndWallDist,
        \binMidpoint{j}) \right)} {\ndWallDist} {\ndWallDist_1}
    {\ndWallDist_2}} {a_j}.
\end{equation}
From equation (\ref{eq:wall-cum-dist}), the wall attachment point
$\ndWallDist_\tn{new}$ of the new bond is normally distributed:
\begin{equation}
  \label{eq:wall-dist}
  \ndWallDist_\tn{new} \sim \mathcal{N}\left( \mu =
    \sin(\binMidpoint{j}), \sigma^2 = \onForceScale\inv \right).
\end{equation}
Therefore when a new bond forms, the platelet attachment point of the
bond is selected using the overall propensity $a_j$ and the wall
attachment point is chosen from the normal distribution
(\ref{eq:wall-dist}) after $\binMidpoint{j}$ is chosen.

In practice the $\ndWallDist$ coordinates are restricted to finite
values. While there is no practical need to do this, it ensures
consistency with the deterministic algorithm where extending the
domain of $\ndWallDist$ to $\reals$ is not possible.

\subsection{Some implementation details}
\label{sec:some-impl-deta}

The stochastic simulation algorithm is described in detail in Appendix
\ref{cha:numerical-schemes}; here I outline the algorithm and mention
some of the important implementation details. Just like the
deterministic algorithm, the stochastic algorithm tracks 3
time-varying unknowns: bonds between the platelet and wall,
translational velocity, and angular velocity. However now the bonds
between the platelet and surface are tracked discretely, and the
number of bonds between the platelet and wall follows a stochastic
process. Both velocities are stochastic processes as well, because of
their dependence on the bonds between the platelet and wall.

Key features of the algorithm are as follows:
\begin{enumerate}
\item Platelet-wall bonds are tracked in an array which stores the two
  endpoints of each bond. Each row represents a single bond; the first
  column stores the $\ndWallDist$ coordinate of the bond (the wall
  attachment point), and the second column stores $j$ (the
  $\recAngle$-bin from which the bond formed.
  \begin{equation}
    \label{eq:bond-list}
    \texttt{bondList} =
    \begin{bmatrix}
      \ndWallDist_0 & j_0 \\
      \ndWallDist_1 & j_1 \\
      \vdots & \vdots \\
      \ndWallDist_{\texttt{numBonds}-1} & j_{\texttt{numBonds} - 1}
    \end{bmatrix}    
  \end{equation}
  where $j_i = 0, \hdots, 2N-1$ and
  $\Der{\ndWallDist_i}{\ndTime} = -\ndVelocity(\ndTime)$ for
  $i = 0, \hdots, \texttt{numBonds} - 1$.

  As time evolves, $\texttt{bondList}$ is updated in two ways: (1) the
  $\ndWallDist$-coordinate changes as the platelet moves, and (2) rows
  are added to or removed from $\texttt{bondList}$ as bonds form or
  break.
\item Values for $\binMidpoint{j}$ are tracked in an array which gets
  updated every time step:
  \begin{equation}
    \label{eq:midpt-list}
    \texttt{midpoints} = \left[\binMidpoint{0}, \binMidpoint{1}, \hdots,
      \binMidpoint{2N - 1}]\right.
  \end{equation}
  The update for each step is
  $\texttt{midpoints} = \texttt{midpoints} + \omega$ where $\omega$ is
  the rotation rate for the current time step.
\item Each time step consists of the following:
  \begin{enumerate}
  \item Calculate the reaction propensities
  \item Find the time to the next reaction and which reaction occurs
  \item Update the bond positions in $\texttt{bondList}$ and
    $\texttt{midpoints}$, and then add/remove a bond to/from
    $\texttt{bondList}$ if necessary
  \item Calculate the new forces and torques
  \item Find the new rolling velocities $\ndVelocity$ and $\ndRotation$.
  \end{enumerate}
\end{enumerate}

\section{Summary}
\label{sec:summary-model}

Our platelet rolling model consists of a simple stochastic rolling
model similar to the adhesive dynamics models for simulating rolling
of a single cell, and a deterministic model integro-PDE model which
gives the mean behavior of a population of cells. The geometry of the
model is reduced to 2D by assuming that motion perpendicular to flow
and parallel to the vessel wall is negligible, and by approximating
the reactive region of the rolling sphere with a cylinder. The
nonspecific colloidal forces included in the adhesive dynamics models
\cite{Hammer2014} are assumed to balance with the bond forces
perpendicular to the wall. Therefore cell motion in the model is
completely described by two quantities: the translational velocity in
the direction of flow $\ndVelocity$ and the angular velocity
$\ndRotation$. The next chapter shows that this model reproduces
reasonable rolling behavior for biologically realistic parameter
values, and is sensitive to changes in parameters associated with
platelet activation. 


% Local Variables:
% TeX-master: "phd-thesis.ltx"
% End:
